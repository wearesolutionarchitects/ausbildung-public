---
import { getCollection } from 'astro:content';

const docs = await getCollection('docs');

// Alle Tags sammeln und die Häufigkeit berechnen
const tagCounts: Record<string, number> = {};

docs.forEach(doc => {
  (doc.data as { tags?: string[] }).tags?.forEach((tag: string) => {
    if (!tagCounts[tag]) tagCounts[tag] = 0;
    tagCounts[tag]++;
  });
});

// Tags nach Häufigkeit sortieren
const sortedTags = Object.entries(tagCounts)
  .sort((a, b) => b[1] - a[1]);

// Funktion zur Bestimmung der Schriftgröße basierend auf der Häufigkeit
const getFontSize = (count: number) => {
  const minSize = 12;
  const maxSize = 32;
  const maxCount = sortedTags[0]?.[1] || 1; // Höchster Tag-Wert als Referenz
  return `${minSize + (maxSize - minSize) * (count / maxCount)}px`;
};
---

<h1>Tag-Wolke</h1>

<div class="tag-cloud">
  {sortedTags.map(([tag, count]) => (
    <a href={`#${tag}`} class="tag" style={`font-size: ${getFontSize(count)}`}>
      {tag} ({count})
    </a>
  ))}
</div>

<style>
  .tag-cloud {
    display: flex;
    flex-wrap: wrap;
    gap: 0.8rem;
    justify-content: center;
    padding: 1rem;
  }

  .tag {
    text-decoration: none;
    color: #007acc;
    font-weight: bold;
    transition: transform 0.2s;
  }

  .tag:hover {
    transform: scale(1.2);
  }
</style>